---
title: –û—Å–Ω–æ–≤–∏ –≤–∏–±—ñ—Ä–∫–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥—É N 3
author: "Khudienko Andrii, KN-24-1"
date: "`r format(Sys.Date(), '%d.%m.%Y')`"
output:
  html_document:
    toc: true
    df_print: paged
  html_notebook:
    toc: true
    toc_float: true
    highlight: tango
fontsize: 12pt
header-includes: |
  \usepackage[T2A]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage[russian]{babel}
editor_options:
  chunk_output_type: console
---

```{r}
# ==============================================================================
# 1. –ü–Ü–î–ì–û–¢–û–í–ö–ê –°–ï–†–ï–î–û–í–ò–©–ê –¢–ê –î–ê–ù–ò–•
# ==============================================================================

# –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫
# install.packages(c("e1071", "dplyr"))
library(e1071) 
library(dplyr)
library(ggplot2) # –î–æ–¥–∞—Ç–∫–æ–≤–æ –¥–ª—è –∫—Ä–∞—â–∏—Ö –≥—Ä–∞—Ñ—ñ–∫—ñ–≤

# –§—ñ–∫—Å–∞—Ü—ñ—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ (–¥–ª—è –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω–æ—Å—Ç—ñ –º–æ—î—ó –≤–∏–±—ñ—Ä–∫–∏)
set.seed(42) 
a <- 0     # –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–µ —Å–ø–æ–¥—ñ–≤–∞–Ω–Ω—è
s <- 1     # –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è (–°–ö–í)
n1 <- 100  # –û–±—Å—è–≥ –ø–µ—Ä—à–æ—ó –≤–∏–±—ñ—Ä–∫–∏
n2 <- 1000 # –û–±—Å—è–≥ –¥—Ä—É–≥–æ—ó –≤–∏–±—ñ—Ä–∫–∏

# –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤–∏–±—ñ—Ä–æ–∫
X100 <- rnorm(n1, a, s) 
X1000 <- rnorm(n2, a, s) 

cat("
## –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è
a = ", a, ", s = ", s, " (N(0, 1))
–û–±—Å—è–≥ –≤–∏–±—ñ—Ä–æ–∫: n1 = ", n1, ", n2 = ", n2, "\n")

# –í–∏–≤—ñ–¥ –æ—Å–Ω–æ–≤–Ω–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è n=1000 (–∑–∞ –ø—Ä–∏–∫–ª–∞–¥–æ–º)
cat("\n## –°—É–º–∞—Ä–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è X1000:\n")
summary(X1000)
cat("\n")

# ==============================================================================
# 2. –§–£–ù–ö–¶–Ü–Ø –î–õ–Ø –û–ë–ß–ò–°–õ–ï–ù–ù–Ø –ï–ú–ü–Ü–†–ò–ß–ù–ò–• –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö
# ==============================================================================

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (–¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ)
calculate_stats <- function(X, n) {
  x_mean <- mean(X)
  x_var_biased <- mean((X - x_mean)^2) # –ó–º—ñ—â–µ–Ω–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è
  x_var_unbiased <- var(X)            # –ù–µ–∑–º—ñ—â–µ–Ω–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è
  x_sd_biased <- sqrt(x_var_biased)   # –ó–º—ñ—â–µ–Ω–µ –°–ö–í
  x_sd_unbiased <- sd(X)              # –ù–µ–∑–º—ñ—â–µ–Ω–µ –°–ö–í
  mu3 <- mean((X - x_mean)^3)
  mu4 <- mean((X - x_mean)^4)
  
  # –ê—Å–∏–º–µ—Ç—Ä—ñ—è —Ç–∞ –ï–∫—Å—Ü–µ—Å (—Ñ—É–Ω–∫—Ü—ñ—ó –∑ e1071 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –Ω–µ–∑–º—ñ—â–µ–Ω—ñ –æ—Ü—ñ–Ω–∫–∏)
  skew <- skewness(X, type = 2) # –¢–∏–ø 2 (G1)
  kurt <- kurtosis(X, type = 2) # –¢–∏–ø 2 (G2, –ï–∫—Å—Ü–µ—Å: Kurtosis - 3)
  
  return(list(
    a_par = x_mean,
    s_par = x_sd_unbiased,
    m_x = x_mean,
    D_biased = x_var_biased,
    D_unbiased = x_var_unbiased,
    sigma_biased = x_sd_biased,
    sigma_unbiased = x_sd_unbiased,
    mu3 = mu3,
    mu4 = mu4,
    As = skew,
    Ek = kurt
  ))
}

stats_100 <- calculate_stats(X100, n1)
stats_1000 <- calculate_stats(X1000, n2)

# ==============================================================================
# 3. –¢–ê–ë–õ–ò–¶–Ø –ß–ò–°–õ–û–í–ò–• –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö (–ü. 5)
# ==============================================================================

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ —É —Ñ–æ—Ä–º–∞—Ç—ñ data frame
table_data <- data.frame(
  "–ù–∞–∑–≤–∞ —á–∏—Å–ª–æ–≤–æ—ó —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏" = c(
    "Œ± (–û—Ü—ñ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ m(x))", 
    "œÉ (–û—Ü—ñ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –°–ö–í)",
    "–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–µ —Å–ø–æ–¥—ñ–≤–∞–Ω–Ω—è m(x)", 
    "–î–∏—Å–ø–µ—Ä—Å—ñ—è D(x) (–∑–º—ñ—â.)", 
    "–í–∏–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–∏—Å–ø–µ—Ä—Å—ñ—è D(x) (–Ω–µ–∑–º—ñ—â.)",
    "–°–ö–í œÉ(x) (–∑–º—ñ—â.)",
    "–í–∏–ø—Ä–∞–≤–ª–µ–Ω–µ –°–ö–í œÉÃÉ(x) (–Ω–µ–∑–º—ñ—â.)",
    "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏–π –º–æ–º–µ–Ω—Ç 3-–≥–æ –ø–æ—Ä—è–¥–∫—É Œº3", 
    "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏–π –º–æ–º–µ–Ω—Ç 4-–≥–æ –ø–æ—Ä—è–¥–∫—É Œº4", 
    "–ê—Å–∏–º–µ—Ç—Ä—ñ—è As", 
    "–ï–∫—Å—Ü–µ—Å Ek"
  ),
  "–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è" = c(a, s, a, s^2, s^2, s, s, 0, 3, 0, 0),
  "–í–∏–±—ñ—Ä–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è, n=100" = round(unlist(stats_100), 6),
  "–í–∏–±—ñ—Ä–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è, n=1000" = round(unlist(stats_1000), 6)
)

# –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è R Notebook (Markdown Table)
cat("
## üìã –¢–∞–±–ª–∏—Ü—è ‚Äì –¢–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ —Ç–∞ –ï–º–ø—ñ—Ä–∏—á–Ω—ñ (–≤–∏–±—ñ—Ä–∫–æ–≤—ñ) —á–∏—Å–ª–æ–≤—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
")
print(knitr::kable(table_data))
cat("\n---")


# ==============================================================================
# 4. –í–Ü–ó–£–ê–õ–Ü–ó–ê–¶–Ü–Ø (–ü. 2, 3, 4)
# ==============================================================================

# –û–±'—î–¥–Ω–∞–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ —É –∫–æ–º–ø–∞–∫—Ç–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç
par(mfrow = c(2, 2), mar = c(4, 4, 3, 1) + 0.1) 

# --- 4.1. –ì—ñ—Å—Ç–æ–≥—Ä–∞–º–∞ —Ç–∞ –§—É–Ω–∫—Ü—ñ—è —â—ñ–ª—å–Ω–æ—Å—Ç—ñ (–ü. 2) ---
hist(X1000, 
     freq = FALSE, 
     col = "Lightblue", 
     main = "–ì—ñ—Å—Ç–æ–≥—Ä–∞–º–∞ —Ç–∞ –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –∫—Ä–∏–≤–∞ (n=1000)", 
     xlab = "X",
     ylab = "Density",
     border = 1)
# –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ—ó –∫—Ä–∏–≤–æ—ó (N(0, 1))
curve(dnorm(x, a, s), 
      col = "darkred", 
      lwd = 2, 
      add = TRUE)
# –î–æ–¥–∞–≤–∞–Ω–Ω—è –µ–º–ø—ñ—Ä–∏—á–Ω–æ—ó –∫—Ä–∏–≤–æ—ó (–æ—Ü—ñ–Ω–∫–∏)
curve(dnorm(x, stats_1000$m_x, stats_1000$s_par), 
      col = "blue", 
      lty = 2,
      lwd = 2, 
      add = TRUE)
legend("topright", 
       legend = c("–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ N(0, 1)", "–ï–º–ø—ñ—Ä–∏—á–Ω–∞"), 
       col = c("darkred", "blue"), 
       lty = c(1, 2), 
       lwd = 2,
       cex = 0.8)


# --- 4.2. –ì—Ä–∞—Ñ—ñ–∫ –§—É–Ω–∫—Ü—ñ–π —Ä–æ–∑–ø–æ–¥—ñ–ª—É (–ü. 3) ---
plot(ecdf(X1000), 
     main = "–ï–º–ø—ñ—Ä–∏—á–Ω–∞ —Ç–∞ –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –§–† (n=1000)",
     xlab = "X", 
     ylab = "F(x)",
     col = "blue", 
     pch = 19,
     verticals = TRUE)
# –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ—ó –§–†
curve(pnorm(x, a, s), 
      col = "red", 
      lwd = 2, 
      add = TRUE)
legend("bottomright", 
       legend = c("–ï–º–ø—ñ—Ä–∏—á–Ω–∞ –§–†", "–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –§–†"), 
       col = c("blue", "red"), 
       lty = 1, 
       lwd = 2,
       cex = 0.8)


# --- 4.3. Box-and-Whisker Plot (–ü. 4) ---
boxplot(X1000, 
        main = "Box-and-Whisker Plot (n=1000)", 
        col = "lightgreen", 
        border = 1,
        xlab = "X",
        horizontal = TRUE) 
points(mean(X1000), 1, pch = 8, col = "red", cex = 1.5) # –ü–æ–∑–Ω–∞—á–∞—î–º–æ —Å–µ—Ä–µ–¥–Ω—î


# --- 4.4. –î–æ–¥–∞—Ç–∫–æ–≤—ñ –≥—Ä–∞—Ñ—ñ–∫–∏: –û—Ü—ñ–Ω–∫–∞ –≥—É—Å—Ç–∏–Ω–∏ + Rug Plot ---
plot(density(X1000, adjust = 1.5), 
     main = "–û—Ü—ñ–Ω–∫–∞ –≥—É—Å—Ç–∏–Ω–∏ (Density Trace)", 
     xlab = "X", 
     ylab = "Density",
     col = "darkgreen", 
     lwd = 2)
# –î–æ–¥–∞–≤–∞–Ω–Ω—è rug plot (–º—ñ—Å—Ü—è –∑–Ω–∞—á–µ–Ω—å)
rug(X1000, col = "gray")


# –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
par(mfrow = c(1, 1))

# ==============================================================================
# 5. –°–¢–ê–¢–ò–°–¢–ò–ß–ù–ò–ô –†–û–ó–ü–û–î–Ü–õ (–Ü–ù–¢–ï–†–í–ê–õ–¨–ù–ê –¢–ê–ë–õ–ò–¶–Ø) (–ü. 1)
# ==============================================================================

cat("\n---
## üî¢ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª (–Ü–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –≤—ñ–¥–Ω–æ—Å–Ω–∏—Ö —á–∞—Å—Ç–æ—Ç)
\n")

# –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
k <- ceiling(1 + 3.322 * log10(n2)) # –ö—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ –∑–∞ –°—Ç–µ—Ä–¥–∂–µ—Å–æ–º
range_x <- max(X1000) - min(X1000)
h <- range_x / k # –î–æ–≤–∂–∏–Ω–∞ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É

# –ü–æ–±—É–¥–æ–≤–∞ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ–≤ —Ç–∞ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —á–∞—Å—Ç–æ—Ç
breaks <- seq(min(X1000), max(X1000) + h, by = h)
counts <- hist(X1000, breaks = breaks, plot = FALSE)$counts
relative_freq <- counts / n2

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ
interval_table <- data.frame(
  "–ù–æ–º–µ—Ä —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É" = 1:k,
  "–ú–µ–∂—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É" = paste0("(", round(breaks[-length(breaks)], 4), ", ", round(breaks[-1], 4), "]"),
  "–ß–∞—Å—Ç–æ—Ç–∞ mi" = counts,
  "–í—ñ–¥–Ω–æ—Å–Ω–∞ —á–∞—Å—Ç–æ—Ç–∞ wi" = round(relative_freq, 4)
)

print(knitr::kable(interval_table))
cat("\n")

# ---
```

